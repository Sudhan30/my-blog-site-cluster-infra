<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Analytics Example</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .btn {
            background: #007cba;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        .btn:hover {
            background: #005a87;
        }
        .analytics-panel {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .metric {
            display: inline-block;
            margin: 10px;
            padding: 10px;
            background: white;
            border-radius: 3px;
            min-width: 100px;
            text-align: center;
        }
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #007cba;
        }
        .metric-label {
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>üìä Blog Analytics Example</h1>
    
    <p>This page demonstrates how to use the Blog Analytics system. Open your browser's developer console to see analytics events being tracked.</p>
    
    <div class="analytics-panel">
        <h2>üéØ Interactive Elements</h2>
        <p>Click these buttons to see click tracking in action:</p>
        
        <button class="btn" id="subscribe-button" onclick="trackNewsletterSignup()">
            üìß Subscribe to Newsletter
        </button>
        
        <button class="btn" id="contact-button" onclick="trackContactClick()">
            üìû Contact Us
        </button>
        
        <button class="btn" id="share-button" onclick="trackShareClick()">
            üîó Share Article
        </button>
        
        <button class="btn" id="like-button" onclick="trackLikeClick()">
            ‚ù§Ô∏è Like This Page
        </button>
    </div>
    
    <div class="analytics-panel">
        <h2>üìà Live Analytics Dashboard</h2>
        <p>Real-time analytics data (refreshes every 30 seconds):</p>
        
        <div id="analytics-dashboard">
            <div class="metric">
                <div class="metric-value" id="total-sessions">-</div>
                <div class="metric-label">Total Sessions</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="bounce-rate">-</div>
                <div class="metric-label">Bounce Rate</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="avg-session">-</div>
                <div class="metric-label">Avg Session</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="page-views">-</div>
                <div class="metric-label">Page Views</div>
            </div>
        </div>
        
        <button class="btn" onclick="refreshAnalytics()">
            üîÑ Refresh Analytics
        </button>
    </div>
    
    <div class="analytics-panel">
        <h2>üìä Manual Event Tracking</h2>
        <p>You can manually track custom events:</p>
        
        <input type="text" id="custom-event-name" placeholder="Event name" style="padding: 5px; margin: 5px;">
        <button class="btn" onclick="trackCustomEvent()">
            üéØ Track Custom Event
        </button>
    </div>
    
    <div style="height: 2000px; background: linear-gradient(to bottom, #f0f0f0, #e0e0e0); margin: 20px 0; padding: 20px;">
        <h2>üìú Scroll Tracking</h2>
        <p>Scroll down this section to see scroll depth tracking in action. Check the console for scroll events.</p>
        <p>This content is intentionally long to demonstrate scroll tracking functionality.</p>
        
        <div style="margin-top: 500px;">
            <h3>Halfway Point</h3>
            <p>You've scrolled 50% of the way down!</p>
        </div>
        
        <div style="margin-top: 500px;">
            <h3>Near the Bottom</h3>
            <p>You're almost at the bottom of the page!</p>
        </div>
    </div>

    <!-- Include the analytics library -->
    <script src="blog-analytics.js"></script>
    
    <script>
        // Custom event tracking functions
        function trackNewsletterSignup() {
            trackEvent('newsletter_signup', {
                source: 'subscribe_button',
                location: 'top_of_page'
            });
            alert('Newsletter signup tracked! Check console for details.');
        }
        
        function trackContactClick() {
            trackEvent('contact_click', {
                source: 'contact_button',
                intent: 'support_request'
            });
            alert('Contact click tracked! Check console for details.');
        }
        
        function trackShareClick() {
            trackEvent('share_click', {
                source: 'share_button',
                platform: 'social_media'
            });
            alert('Share click tracked! Check console for details.');
        }
        
        function trackLikeClick() {
            trackEvent('like_click', {
                source: 'like_button',
                content_type: 'page'
            });
            alert('Like click tracked! Check console for details.');
        }
        
        function trackCustomEvent() {
            const eventName = document.getElementById('custom-event-name').value;
            if (!eventName) {
                alert('Please enter an event name');
                return;
            }
            
            trackEvent(eventName, {
                source: 'manual_tracking',
                timestamp: new Date().toISOString()
            });
            
            alert(`Custom event "${eventName}" tracked! Check console for details.`);
            document.getElementById('custom-event-name').value = '';
        }
        
        // Analytics dashboard functions
        async function refreshAnalytics() {
            try {
                const data = await window.blogAnalytics.getDashboardData(7);
                if (data) {
                    updateDashboard(data);
                }
            } catch (error) {
                console.error('Error refreshing analytics:', error);
            }
        }
        
        function updateDashboard(data) {
            const sessionStats = data.sessionStats;
            
            document.getElementById('total-sessions').textContent = sessionStats.total_sessions || 0;
            document.getElementById('bounce-rate').textContent = 
                sessionStats.bounce_rate ? sessionStats.bounce_rate.toFixed(1) + '%' : '0%';
            document.getElementById('avg-session').textContent = 
                sessionStats.avg_session_duration ? Math.round(sessionStats.avg_session_duration) + 's' : '0s';
            document.getElementById('page-views').textContent = data.pageViews.length || 0;
        }
        
        // Auto-refresh analytics every 30 seconds
        setInterval(refreshAnalytics, 30000);
        
        // Initial load
        refreshAnalytics();
        
        // Log analytics initialization
        console.log('üöÄ Blog Analytics initialized!');
        console.log('üìä User UUID:', window.blogAnalytics.uuid);
        console.log('üîó Session ID:', window.blogAnalytics.sessionId);
        console.log('üì± Device Type:', window.blogAnalytics.getDeviceType());
        console.log('üåê Browser:', window.blogAnalytics.getBrowser());
        console.log('üíª OS:', window.blogAnalytics.getOS());
    </script>
</body>
</html>
