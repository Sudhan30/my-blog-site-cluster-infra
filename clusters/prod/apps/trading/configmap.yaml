---
apiVersion: v1
kind: ConfigMap
metadata:
  name: trading-config
  namespace: trading
data:
  config.yaml: |
    # Algorithmic Trading System Configuration
    # This config is mounted into the trading services
    
    broker:
      name: "alpaca"
      paper_trading: true
      base_url: "https://paper-api.alpaca.markets"
    
    market_data:
      primary_source: "alpaca"
      backup_source: "yfinance"
      websocket_enabled: true
    
    stock_universe:
      update_frequency: "daily"
      max_stocks: 50
      min_price: 5.0
      min_volume: 1000000
    
    trading_hours:
      market_open: "09:30"
      market_close: "16:00"
      premarket_enabled: false
      afterhours_enabled: false
    
    # STOCK_ONLY Mode Configuration
    # When enabled, disables all crypto trading and enforces US market hours
    market_mode:
      stock_only: true              # Disable crypto, NYSE/NASDAQ only
      allowed_exchanges:
        - NYSE
        - NASDAQ
      backfill_lookback_days: 15    # Trading days to look back for gap repair
    
    risk_management:
      max_portfolio_risk_pct: 5.0
      max_position_size_pct: 50.0
      max_daily_loss_pct: 5.0
      max_daily_loss_amount: 500.0
      max_correlation: 0.7
      pdt_rule:
        enabled: false
        max_day_trades: 999
        tracking_days: 5
        min_balance_exempt: 25000
    
    strategies:
      moving_average:
        enabled: false
        short_period: 9
        long_period: 21
        timeframe_day_trade: "5min"
        timeframe_long_term: "1day"
        min_volume_multiplier: 1.5
      
      mean_reversion:
        enabled: true
        bollinger_period: 20
        bollinger_std: 2.0
        rsi_period: 14
        rsi_oversold: 25
        rsi_overbought: 70
        timeframe: "15min"
      
      momentum:
        enabled: true
        roc_period: 12
        roc_threshold: 5.0
        rsi_period: 14
        macd_fast: 12
        macd_slow: 26
        macd_signal: 9
        volume_confirmation: true
        timeframe: "30min"
      
      dip_buyer:
        enabled: true
        dip_percentage: 5.0
        lookback_period: 24
      
      breakout:
        enabled: true
        lookback_period: 20
        volume_threshold: 1.5
      
      news_sentiment:
        enabled: true
        sentiment_threshold: 0.3
        news_limit: 5
      
      trend_following:
        enabled: true
        ema_period: 50
        rsi_period: 14
        rsi_entry: 30
        volume_threshold: 1.2
      
      golden_cross:
        enabled: true
        fast_period: 50
        slow_period: 200
        confirmation_bars: 3
      
      scalping:
        enabled: false  # Disabled - conflicts with 30-min hold time
        rsi_oversold: 40
        rsi_overbought: 60
        profit_target_pct: 1.0
        volume_threshold: 1.0
    
    position_management:
      take_profit_pct: 5.0
      stop_loss_pct: 2.0
      trailing_stop: true
      trailing_stop_pct: 3.0
      partial_exit: false
    
    database:
      host: "timescaledb"
      port: 5432
      name: "trading_db"
      user: "trading_user"
    
    redis:
      host: "redis"
      port: 6379
      db: 0
    
    logging:
      level: "INFO"
      format: "json"
      retention_days: 90
